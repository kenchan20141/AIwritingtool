<!DOCTYPE html>
<html>
<head>
  <title>DeepSeek å¯«ä½œåŠ©æ‰‹</title>
  <meta charset="UTF-8">
  <style>
    /* CSS æ¨£å¼ */
    body {
      font-family: 'Microsoft JhengHei', sans-serif;
      background: #f0f2f5;
      padding: 20px;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
    }

    .section {
      margin: 25px 0;
      padding: 20px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    button {
      background: #2d8cf0;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      transition: 0.3s;
    }

    button:hover {
      background: #0066cc;
    }

    textarea {
      width: 100%;
      height: 200px;
      padding: 15px;
      border: 2px solid #e8e8e8;
      border-radius: 8px;
      font-size: 16px;
      margin: 10px 0;
    }

    .output-box {
      padding: 15px;
      background: #f8f9fa;
      border-radius: 8px;
      margin-top: 10px;
      min-height: 60px;
    }

    .loading {
      display: none;
      color: #666;
      font-style: italic;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ¯ AI å¯«ä½œè¨“ç·´ç‡Ÿ</h1>
    
    <!-- é¡Œç›®ç”Ÿæˆå€ -->
    <div class="section">
      <button onclick="generateTopic()">ğŸª„ éš¨æ©Ÿç”Ÿæˆé¡Œç›®</button>
      <div id="topic" class="output-box"></div>
    </div>

    <!-- å¯«ä½œå€ -->
    <div class="section">
      <textarea id="userWriting" placeholder="âœï¸ åœ¨æ­¤è¼¸å…¥ä½ çš„å¯«ä½œå…§å®¹..."></textarea>
    </div>

    <!-- æ‰¹æ”¹å€ -->
    <div class="section">
      <button onclick="submitForReview()">ğŸ” æäº¤AIæ‰¹æ”¹</button>
      <div id="feedback" class="output-box"></div>
      <div id="loading" class="loading">AIæ‰¹æ”¹ä¸­... (ç´„10-20ç§’)</div>
    </div>
  </div>

  <script>
    // ======================
    // é‡è¦è¨­å®š (ä½¿ç”¨å‰å¿…å¡«ï¼)
    // ======================
    const API_KEY = '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'; // æ›¿æ›æˆä½ çš„APIé‡‘é‘°
    const API_ENDPOINT = 'https://openrouter.ai/api/v1';
    
    // ======================
    // æ ¸å¿ƒåŠŸèƒ½ä»£ç¢¼
    // ======================
    async function handleAPICall(messages) {
      try {
        document.getElementById('loading').style.display = 'block';
        
        const response = await fetch(API_ENDPOINT, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${API_KEY}`
          },
          body: JSON.stringify({
            model: "deepseek-chat",
            messages: messages
          })
        });

        if (!response.ok) {
          throw new Error(`APIè«‹æ±‚å¤±æ•— (ç‹€æ…‹ç¢¼: ${response.status})`);
        }

        const data = await response.json();
        return data.choices[0].message.content;

      } catch (error) {
        alert(`éŒ¯èª¤ï¼š${error.message}\nè«‹æª¢æŸ¥ç¶²çµ¡é€£æ¥æˆ–APIé‡‘é‘°`);
        return null;
      } finally {
        document.getElementById('loading').style.display = 'none';
      }
    }

    // ç”Ÿæˆé¡Œç›®åŠŸèƒ½
    async function generateTopic() {
      const systemPrompt = {
        role: "system",
        content: "ä½ æ˜¯ä¸€ä½ä¸­æ–‡å¯«ä½œè€å¸«ï¼Œè«‹ç”Ÿæˆä¸€å€‹åŒ…å«å…·é«”æƒ…æ™¯æå¯«è¦æ±‚çš„ä½œæ–‡é¡Œç›®ï¼Œæ ¼å¼ç¯„ä¾‹ï¼š'è«‹æå¯«ä¸€å€‹é›¨å¾Œæ ¡åœ’çš„å ´æ™¯ï¼Œè¦æ±‚ä½¿ç”¨è‡³å°‘ä¸‰å€‹æ¯”å–»å¥'"
      };

      const result = await handleAPICall([systemPrompt]);
      if (result) {
        document.getElementById('topic').innerHTML = `ğŸ“Œ ä»Šæ—¥é¡Œç›®ï¼š<br>${result}`;
      }
    }

    // æäº¤æ‰¹æ”¹åŠŸèƒ½
    async function submitForReview() {
      const userText = document.getElementById('userWriting').value.trim();
      
      if (!userText) {
        alert("è«‹å…ˆè¼¸å…¥å¯«ä½œå…§å®¹ï¼");
        return;
      }

      const systemPrompt = {
        role: "system",
        content: `ä½ æ˜¯ä¸€ä½å°ˆæ¥­çš„ä¸­æ–‡å¯«ä½œæ‰¹æ”¹è€å¸«ï¼Œè«‹æŒ‰ç…§ä»¥ä¸‹æ­¥é©Ÿè™•ç†ï¼š
        1. æŒ‡å‡º3å€‹å„ªé»ä¸¦æ¨™è¨»â­
        2. æ‰¾å‡º3å€‹å¯æ”¹é€²é»ä¸¦æ¨™è¨»ğŸ”§
        3. çµ¦å‡ºä¿®æ”¹å»ºè­°
        4. æœ€å¾Œç”¨ã€ç¶œåˆè©•åˆ†ã€‘çµ¦åˆ†(æ»¿åˆ†5åˆ†)
        è«‹ç”¨è¡¨æ ¼æ ¼å¼å›æ‡‰`
      };

      const userMessage = {
        role: "user",
        content: userText
      };

      const result = await handleAPICall([systemPrompt, userMessage]);
      if (result) {
        document.getElementById('feedback').innerHTML = result.replace(/\n/g, '<br>');
      }
    }
  </script>
</body>
</html>
