<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI 寫作工具</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    h1 {
      color: #333;
    }
    #prompt, #feedback {
      white-space: pre-wrap;
      margin-top: 10px;
      margin-bottom: 10px;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    textarea {
      display: block;
      margin-top: 10px;
      margin-bottom: 10px;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      width: 100%;
      height: 150px;
    }
    button {
      padding: 10px 20px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background-color: #0056b3;
    }
  </style>
</head>
<body>
  <h1>AI 寫作工具</h1>
  <button onclick="generatePrompt()">生成新題目</button>
  <div id="prompt"></div>
  <textarea id="writing" placeholder="請在這裡寫下您的回答..."></textarea>
  <button onclick="getFeedback()">提交並獲取反饋</button>
  <div id="feedback"></div>
  <script>
    const API_URL = 'https://openrouter.ai/api/v1/chat/completions';
    const API_KEY = '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';

    async function callAPI(messages) {
      const response = await fetch(API_URL, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${API_KEY}`
        },
        body: JSON.stringify({
          model: 'deepseek/deepseek-chat',
          messages: messages,
          stream: false
        })
      });
      const data = await response.json();
      return data.choices[0].message.content;
    }

    async function generatePrompt() {
      const messages = [
        {"role": "system", "content": "你是一個專為學生生成創意寫作題目的 AI。"},
        {"role": "user", "content": "請生成一個寫作題目。"}
      ];
      const prompt = await callAPI(messages);
      document.getElementById('prompt').innerText = prompt;
    }

    async function getFeedback() {
      const studentWriting = document.getElementById('writing').value;
      const messages = [
        {"role": "system", "content": "你是一個 AI 寫作助手，負責修訂學生的寫作並提供建設性反饋。請修訂以下寫作內容，然後提供改進建議。"},
        {"role": "user", "content": `學生的寫作：${studentWriting}`}
      ];
      const feedback = await callAPI(messages);
      document.getElementById('feedback').innerText = feedback;
    }

    window.onload = generatePrompt;
  </script>
</body>
</html>
