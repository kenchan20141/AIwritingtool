<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI寫作助手</title>
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f4f4f4;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .box {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            padding: 20px;
            margin: 15px 0;
        }
        button {
            background: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.3s;
        }
        button:hover {
            background: #0056b3;
        }
        select, textarea {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        textarea {
            resize: vertical;
        }
        #topicResult, #commentResult {
            margin-top: 15px;
            color: #333;
        }
    </style>
</head>
<body>
    <h1>AI寫作助手</h1>

    <!-- 範疇選擇 -->
    <div class="box">
        <label for="category">選擇練習範疇：</label>
        <select id="category">
            <option value="示現敘事">示現敘事</option>
            <option value="大綱">大綱</option>
            <option value="片段詳略">片段詳略</option>
        </select>
    </div>

    <!-- 生成題目區域 -->
    <div class="box">
        <button onclick="generateTopic()">生成寫作題目</button>
        <div id="topicResult"></div>
    </div>

    <!-- 寫作區域 -->
    <div class="box">
        <textarea id="writingContent" rows="10" placeholder="請在此輸入您的寫作內容..."></textarea>
        <button onclick="submitWriting()">提交作文</button>
        <div id="commentResult"></div>
    </div>

    <script>
        // API 配置信息
        const API_KEY = "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";
        const API_URL = "https://openrouter.ai/api/v1/chat/completions";
        const MODEL = "deepseek/deepseek-r1:free";

        // 範疇定義（包括出題提示和教學筆記）
        const categories = {
            "示現敘事": {
                topicPrompt: "請生成一道適合中學生練習示現敘事的題目，要求：1.貼近生活 2.10字以內 3.加快生成速度 4.除了題目之外，不要生成其他任何內容",
                commentNote: "必須就上述生成的題目點評寫作內容是否扣題。此外，所謂「示現敘事」，是指行文時運用小物件、動作、對話和內心獨白這四種敘事方式。 一. 小物件敘事 特點 節奏：慢 細緻程度：高 - 敘事直接程度：低 用途 1. 渲染氛圍，將故事娓娓道來。 2. 側面映襯人物感情及主題。 3. 用於過渡，連接不同的情節。 要求 - 文章每個小物件句組的長度應達4到6句，- 適時穿插1-3句的短句組，使敘事節奏錯落而富變化。主語相同或結構相同（例如對偶和排比），某些短語會被定義為同一句組內。 - 小物件應促進情節發展，並側面映襯人物情感或主題。最好能夠引發讀者從不同方向作聯想，而且該些聯想方向都是合情合理的，例如題目為「離別」，主題為離婚，文中寫及「戒指沉默地掉進大海，像張翕的嘴唇，只會無聲地吶喊」，那麼這裡的「戒指掉進大海」，可以象徵婚姻關係的破裂，亦可以象徵主角對丈夫已經失望透極。兩者都是合理的聯想方向，這些聯想方向能夠引起不同的合理解讀，從而增加文學性，令讀者有不同角度去感受和欣賞文中角色的感情。 - 用於描述景、物及人的細節時，應注意與主題的聯繫，且能夠呈現出場境的特點。例如場境為「故鄉」，則可多運用紅磚、柿樹、河流、蟬鳴、老屋、風箏等等的小物件敘事。 示例分析： 「自製的銀行存款證明書」（提示與母親的癡呆症相關、具有深層意涵） 二. 動作敘事 特點 節奏：中 細緻程度：高／較高 敘事直接程度：中 用途 1. 為重要情節補充細節，以突顯主題。 要求 - 動作刻畫應詳細，每個句組長度達3到4句。 - 動作的細節應促進情節發展，並側面映襯人物情感或主題。例如題目為「等待」，主題為主角的母親患上了老人癡呆症，已經遺忘了自己的女兒已經長大成人，她只記得女兒以前夜歸傷透了自己的心。那麼可以寫主角「我摩娑她的頭髮，不敢用力，恍如她從前摩娑我一樣，我們互相交換溫柔，但我們都錯過了對方。」這裡的「摩娑」可以被解讀成不同的感情，例如是愛，或者是償還，或者是回味。 - 適時穿插1-2句的短句組，使敘事節奏錯落而富變化。 示例分析： - 「我顫抖著手摩娑她的頭髮，/呆了半晌，/然後像一隻受驚的野獸，/緊緊地擁抱她。」 三. 對話敘事 特點 節奏：慢 細緻程度：低 敘事直接程度：中 用途 1. 突顯情節重點或人物感情，而非僅僅交代情節。 要求 - 對話應突出文章的立意或結構重點，而非僅交代情節。 - 應與文章主題緊密相關，充實且具有情感張力。 示例分析： - 「我等你。」（如題目是「這句話，我會記上一輩子」，那麼「我等你」便與「這句話」直接相關。它呼應了題目，亦簡潔有力，直接突顯人物情感） 四. 內心獨白 特點 節奏：快 細緻程度：自由 敘事直接程度：高 用途 1. 略寫較次要的片段。 2. 帶出人物心理、扣題內容和立意。 3. 有時「內心獨白」中，亦嵌入了小物件和動作的敘事，這種內心獨白有利於渲染氛圍，使讀者能夠容易聯想到故事的畫面。 要求 - 用於略寫次要片段，帶出心理活動、扣題內容和立意。 - 觀察獨白是否過多，以免缺乏細節，顯得粗疏。 綜合要求 1. 四種敘事方式應交替使用，保持適當的比例： - 小物件和動作敘事：約佔50% - 內心獨白：約佔35% - 對話：不超過15%（盡量避免運用，改寫時更加不要增加篇幅） 假如文章不少內容都能引發讀者的聯想，而且充滿真摯的感情，則即使內心獨白佔比較重，亦算是合適。 2. 確認節奏、細緻程度及敘事直接程度多樣化，避免過於單一： - 過於側重小物件敘事，則節奏拖沓，語焉不詳。 - 過於側重對話敘事，則質木無文，淡然寡味。 - 過於側重動作敘事，則較少映襯，立體感欠奉。 - 過於側重內心獨白，則缺少細節，內容粗疏。 3. 分析片段的敘事節奏、細緻程度及敘事直接程度，同時檢查是否過於側重某一種方式，並指出可能產生的問題。"
            },
            "大綱": {
                topicPrompt: "請生成一道適合中學生練習寫作大綱的題目，要求：1.貼近生活 2.10字以內 3.加快生成速度 4.除了題目之外，不要生成其他任何內容",
                commentNote: "在寫作大綱時，學生應展示他們組織思路和結構故事的能力。評分時，請注意大綱的邏輯性、條理性以及是否包含了故事的起承轉合。"
            },
            "片段詳略": {
                topicPrompt: "請生成一道適合中學生練習片段詳略的題目，要求：1.貼近生活 2.10字以內 3.加快生成速度 4.除了題目之外，不要生成其他任何內容",
                commentNote: "在片段詳略中，學生需要學會在敘述中控制節奏，通過詳寫重要場景和略寫次要部分來增強故事效果。評分時，請注意學生是否恰當地運用了詳略得當的技巧。"
            }
        };

        // 生成寫作題目
        async function generateTopic() {
            const category = document.getElementById("category").value;
            const prompt = categories[category].topicPrompt;

            // 顯示加載提示
            document.getElementById("topicResult").innerHTML = "正在生成題目...";

            try {
                const response = await fetch(API_URL, {
                    method: "POST",
                    headers: {
                        "Authorization": `Bearer ${API_KEY}`,
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({
                        model: MODEL,
                        messages: [{ role: "user", content: prompt }]
                    })
                });

                const data = await response.json();
                document.getElementById("topicResult").innerHTML = 
                    "今日題目：<strong>" + data.choices[0].message.content + "</strong>";
            } catch (error) {
                alert("生成題目時出錯，請重試");
                document.getElementById("topicResult").innerHTML = "";
            }
        }

        // 提交作文獲取點評
        async function submitWriting() {
            const content = document.getElementById("writingContent").value;
            if (!content) {
                alert("請先輸入寫作內容");
                return;
            }

            const category = document.getElementById("category").value;
            const note = categories[category].commentNote;
            const prompt = `請根據以下內容進行點評（要求：1.簡明扼要 2.參考教學筆記）：\n${content}\n\n教學筆記：${note}`;

            // 顯示加載提示
            document.getElementById("commentResult").innerHTML = "正在生成點評...";

            try {
                const response = await fetch(API_URL, {
                    method: "POST",
                    headers: {
                        "Authorization": `Bearer ${API_KEY}`,
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({
                        model: MODEL,
                        messages: [{ role: "user", content: prompt }]
                    })
                });

                const data = await response.json();
                document.getElementById("commentResult").innerHTML = 
                    "<h3>AI點評：</h3>" + data.choices[0].message.content.replace(/\n/g, "<br>");
            } catch (error) {
                alert("點評生成失敗，請重試");
                document.getElementById("commentResult").innerHTML = "";
            }
        }
    </script>
</body>
</html>
